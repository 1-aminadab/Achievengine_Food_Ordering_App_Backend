
> food-ordering-backend@1.0.0 dev
> nodemon src/index.ts

[33m[nodemon] 3.1.10[39m
[33m[nodemon] to restart at any time, enter `rs`[39m
[33m[nodemon] watching path(s): *.*[39m
[33m[nodemon] watching extensions: ts,json[39m
[32m[nodemon] starting `ts-node src/index.ts`[39m
‚ùå Failed to connect to MongoDB: MongooseServerSelectionError: Could not connect to any servers in your MongoDB Atlas cluster. One common reason is that you're trying to access the database from an IP that isn't whitelisted. Make sure your current IP address is on your Atlas cluster's IP whitelist: https://www.mongodb.com/docs/atlas/security-whitelist/
    at _handleConnectionErrors (/Users/yoni/Documents/Personal/Projects/food_ordering_app/backend/node_modules/mongoose/lib/connection.js:816:11)
    at NativeConnection.openUri (/Users/yoni/Documents/Personal/Projects/food_ordering_app/backend/node_modules/mongoose/lib/connection.js:791:11)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async connectDatabase (/Users/yoni/Documents/Personal/Projects/food_ordering_app/backend/src/services/database.ts:18:5)
    at async startServer (/Users/yoni/Documents/Personal/Projects/food_ordering_app/backend/src/index.ts:132:5) {
  reason: TopologyDescription {
    type: 'ReplicaSetNoPrimary',
    servers: Map(3) {
      'ac-kyrbsgd-shard-00-00.dvvkrcu.mongodb.net:27017' => [ServerDescription],
      'ac-kyrbsgd-shard-00-01.dvvkrcu.mongodb.net:27017' => [ServerDescription],
      'ac-kyrbsgd-shard-00-02.dvvkrcu.mongodb.net:27017' => [ServerDescription]
    },
    stale: false,
    compatible: true,
    heartbeatFrequencyMS: 10000,
    localThresholdMS: 15,
    setName: 'atlas-crsheo-shard-0',
    maxElectionId: null,
    maxSetVersion: null,
    commonWireVersion: 0,
    logicalSessionTimeoutMinutes: null
  },
  code: undefined
}
[31m[nodemon] app crashed - waiting for file changes before starting...[39m
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `ts-node src/index.ts`[39m
‚úÖ Connected to MongoDB
üìä Using existing data from MongoDB Atlas cluster
üöÄ Server running on port 3000
üìç Health check: http://localhost:3000/health
üìö API docs: http://localhost:3000/api
üì§ Upload API: http://localhost:3000/api/upload/image
üçï Foods API: http://localhost:3000/api/foods
üé´ Promo codes API: http://localhost:3000/api/promo-codes/active
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `ts-node src/index.ts`[39m
‚ùå Failed to connect to MongoDB: MongooseServerSelectionError: Server selection timed out after 5000 ms
    at _handleConnectionErrors (/Users/yoni/Documents/Personal/Projects/food_ordering_app/backend/node_modules/mongoose/lib/connection.js:816:11)
    at NativeConnection.openUri (/Users/yoni/Documents/Personal/Projects/food_ordering_app/backend/node_modules/mongoose/lib/connection.js:791:11)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async connectDatabase (/Users/yoni/Documents/Personal/Projects/food_ordering_app/backend/src/services/database.ts:18:5)
    at async startServer (/Users/yoni/Documents/Personal/Projects/food_ordering_app/backend/src/index.ts:133:7) {
  reason: TopologyDescription {
    type: 'ReplicaSetNoPrimary',
    servers: Map(3) {
      'ac-kyrbsgd-shard-00-00.dvvkrcu.mongodb.net:27017' => [ServerDescription],
      'ac-kyrbsgd-shard-00-01.dvvkrcu.mongodb.net:27017' => [ServerDescription],
      'ac-kyrbsgd-shard-00-02.dvvkrcu.mongodb.net:27017' => [ServerDescription]
    },
    stale: false,
    compatible: true,
    heartbeatFrequencyMS: 10000,
    localThresholdMS: 15,
    setName: 'atlas-crsheo-shard-0',
    maxElectionId: null,
    maxSetVersion: null,
    commonWireVersion: 0,
    logicalSessionTimeoutMinutes: 30
  },
  code: undefined
}
‚ö†Ô∏è Database connection failed, continuing without database for file upload functionality
üí° Some endpoints may not work without database connection
üöÄ Server running on port 3000
üìç Health check: http://localhost:3000/health
üìö API docs: http://localhost:3000/api
üì§ Upload API: http://localhost:3000/api/upload/image
üçï Foods API: http://localhost:3000/api/foods
üé´ Promo codes API: http://localhost:3000/api/promo-codes/active
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `ts-node src/index.ts`[39m
‚úÖ Connected to MongoDB
üìä Using existing data from MongoDB Atlas cluster
Uncaught Exception: Error: listen EADDRINUSE: address already in use :::3000
    at Server.setupListenHandle [as _listen2] (node:net:1940:16)
    at listenInCluster (node:net:1997:12)
    at Server.listen (node:net:2102:7)
    at Function.listen (/Users/yoni/Documents/Personal/Projects/food_ordering_app/backend/node_modules/express/lib/application.js:635:24)
    at startServer (/Users/yoni/Documents/Personal/Projects/food_ordering_app/backend/src/index.ts:141:9)
    at processTicksAndRejections (node:internal/process/task_queues:105:5) {
  code: 'EADDRINUSE',
  errno: -48,
  syscall: 'listen',
  address: '::',
  port: 3000
}
[31m[nodemon] app crashed - waiting for file changes before starting...[39m
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `ts-node src/index.ts`[39m
‚ùå Failed to connect to MongoDB: MongooseServerSelectionError: Server selection timed out after 5000 ms
    at _handleConnectionErrors (/Users/yoni/Documents/Personal/Projects/food_ordering_app/backend/node_modules/mongoose/lib/connection.js:816:11)
    at NativeConnection.openUri (/Users/yoni/Documents/Personal/Projects/food_ordering_app/backend/node_modules/mongoose/lib/connection.js:791:11)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async connectDatabase (/Users/yoni/Documents/Personal/Projects/food_ordering_app/backend/src/services/database.ts:18:5)
    at async startServer (/Users/yoni/Documents/Personal/Projects/food_ordering_app/backend/src/index.ts:133:7) {
  reason: TopologyDescription {
    type: 'ReplicaSetNoPrimary',
    servers: Map(3) {
      'ac-kyrbsgd-shard-00-00.dvvkrcu.mongodb.net:27017' => [ServerDescription],
      'ac-kyrbsgd-shard-00-02.dvvkrcu.mongodb.net:27017' => [ServerDescription],
      'ac-kyrbsgd-shard-00-01.dvvkrcu.mongodb.net:27017' => [ServerDescription]
    },
    stale: false,
    compatible: true,
    heartbeatFrequencyMS: 10000,
    localThresholdMS: 15,
    setName: 'atlas-crsheo-shard-0',
    maxElectionId: null,
    maxSetVersion: null,
    commonWireVersion: 0,
    logicalSessionTimeoutMinutes: 30
  },
  code: undefined
}
‚ö†Ô∏è Database connection failed, continuing without database for file upload functionality
üí° Some endpoints may not work without database connection
üöÄ Server running on port 3000
üìç Health check: http://localhost:3000/health
üìö API docs: http://localhost:3000/api
üì§ Upload API: http://localhost:3000/api/upload/image
üçï Foods API: http://localhost:3000/api/foods
üé´ Promo codes API: http://localhost:3000/api/promo-codes/active
Upload request received
Request headers: {
  host: 'localhost:3000',
  'user-agent': 'curl/8.7.1',
  accept: '*/*',
  'content-length': '1741',
  'content-type': 'multipart/form-data; boundary=------------------------edsOXSnmwRHYlX5RloACrw'
}
Request body keys: []
Multer error: Error: Only image files are allowed!
    at fileFilter (/Users/yoni/Documents/Personal/Projects/food_ordering_app/backend/src/routes/uploadRoutes.ts:33:8)
    at wrappedFileFilter (/Users/yoni/Documents/Personal/Projects/food_ordering_app/backend/node_modules/multer/index.js:44:7)
    at Multipart.<anonymous> (/Users/yoni/Documents/Personal/Projects/food_ordering_app/backend/node_modules/multer/lib/make-middleware.js:109:7)
    at Multipart.emit (node:events:518:28)
    at Multipart.emit (node:domain:489:12)
    at HeaderParser.cb (/Users/yoni/Documents/Personal/Projects/food_ordering_app/backend/node_modules/busboy/lib/types/multipart.js:358:14)
    at HeaderParser.push (/Users/yoni/Documents/Personal/Projects/food_ordering_app/backend/node_modules/busboy/lib/types/multipart.js:162:20)
    at SBMH.ssCb [as _cb] (/Users/yoni/Documents/Personal/Projects/food_ordering_app/backend/node_modules/busboy/lib/types/multipart.js:394:37)
    at feed (/Users/yoni/Documents/Personal/Projects/food_ordering_app/backend/node_modules/streamsearch/lib/sbmh.js:219:14)
    at SBMH.push (/Users/yoni/Documents/Personal/Projects/food_ordering_app/backend/node_modules/streamsearch/lib/sbmh.js:104:16) {
  storageErrors: []
}
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `ts-node src/index.ts`[39m
‚úÖ Connected to MongoDB
üìä Using existing data from MongoDB Atlas cluster
Uncaught Exception: Error: listen EADDRINUSE: address already in use :::3000
    at Server.setupListenHandle [as _listen2] (node:net:1940:16)
    at listenInCluster (node:net:1997:12)
    at Server.listen (node:net:2102:7)
    at Function.listen (/Users/yoni/Documents/Personal/Projects/food_ordering_app/backend/node_modules/express/lib/application.js:635:24)
    at startServer (/Users/yoni/Documents/Personal/Projects/food_ordering_app/backend/src/index.ts:141:9)
    at processTicksAndRejections (node:internal/process/task_queues:105:5) {
  code: 'EADDRINUSE',
  errno: -48,
  syscall: 'listen',
  address: '::',
  port: 3000
}
[31m[nodemon] app crashed - waiting for file changes before starting...[39m
